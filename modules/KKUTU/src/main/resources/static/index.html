<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>yeedochi/kkutu</title>
    <link rel="stylesheet" href="/style.css">

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600&display=swap" rel="stylesheet">

    <style>
        /* 게임 전용 스타일 */
        #chatOutput { height: 350px; overflow-y: auto; background: var(--input-bg); border: 1px solid var(--border-color); border-radius: 6px; padding: 10px; margin-bottom: 10px; font-size: 14px; }
        #chatOutput p { margin: 2px 0; padding: 4px 8px; }
        #chatOutput p:nth-child(even) { background-color: rgba(127,127,127,0.05); }

        /* [수정] 잘못된 ID(#roomListOutput)를 올바른 클래스(.room-item)로 변경 */
        #room-list { list-style: none; padding: 0; margin: 0; }
        .room-item { padding: 12px 16px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .room-item:first-child { border-top: none; }
        .room-item:last-child { border-bottom: none; }
    </style>
</head>
<body>
<div id="alert-modal" class="hidden" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); display:flex; justify-content:center; align-items:center; z-index:2000;">
    <div class="box" style="width:320px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
        <div class="box-header">알림</div>
        <div style="padding: 20px; text-align: center; color: var(--text-primary);">
            <p id="alert-msg-text" style="margin: 0; word-break: keep-all;">메시지 내용</p>
        </div>
        <div style="padding:16px; border-top: 1px solid var(--border-color);">
            <button class="btn-primary" onclick="closeAlert()" style="width: 100%;">확인</button>
        </div>
    </div>
</div>
<header>
    <div class="repo-breadcrumb">
        <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" width="30" style="border-radius:50%; opacity:1;">
        <a href="/" class="user-name">game-hub</a>
        <span style="color:var(--text-primary)">/</span>
        <a href="#" class="repo-name">kkutu</a>
        <span class="badge">Public</span>
    </div>
    <button class="theme-btn" onclick="toggleTheme()" id="themeBtn">Dark</button>
</header>

<div id="login-screen" class="container" style="max-width: 400px; margin-top: 50px;">
    <div class="box">
        <div class="box-header">게임 입장</div>
        <div style="padding: 20px;">
            <label style="display:block; font-weight:600; margin-bottom: 8px; font-size: 14px;">닉네임</label>
            <input type="text" id="nicknameInput" placeholder="닉네임을 입력하세요" onkeypress="if(event.key==='Enter') goToLobby()">
            <button class="btn-primary" onclick="goToLobby()" style="width:100%; margin-top:20px;">입장하기</button>
        </div>
    </div>
</div>

<div id="lobby" class="container hidden">
    <div class="box">
        <div class="box-header">
            <span>대기실</span>
            <span id="welcome-msg" style="font-weight:normal; font-size: 12px; color: var(--text-secondary);"></span>
        </div>

        <div style="padding: 16px; background: var(--bg-header); border-bottom: 1px solid var(--border-color); display:flex; gap:10px; flex-wrap:wrap;">
            <input type="text" id="roomName" placeholder="방 제목" value="즐거운 끝말잇기" style="flex:2; min-width: 150px;">
            <div style="display:flex; gap:5px; align-items:center;">
                <label style="font-size:12px; color:var(--text-secondary);">인원:</label>
                <input type="number" id="maxPlayers" value="4" min="2" max="8" style="width:50px;">
                <label style="font-size:12px; color:var(--text-secondary);">봇:</label>
                <input type="number" id="botCount" value="1" min="0" max="7" style="width:50px;">
            </div>
            <button class="btn-primary" onclick="createRoom()">방 만들기</button>
        </div>

        <div style="max-height: 400px; overflow-y: auto;">
            <div style="padding: 10px 16px; font-weight: 600; font-size: 14px; border-bottom: 1px solid var(--border-color); display:flex; justify-content: space-between; background-color: var(--box-bg); align-items: center;">
                <span>개설된 방 목록</span>
                <button class="btn-default" onclick="loadRooms()" style="font-size: 12px; padding: 4px 10px;">
                    <i class="fas fa-sync-alt"></i> 새로고침
                </button>
            </div>

            <ul id="room-list" style="list-style: none; padding: 0; margin: 0;">
            </ul>
        </div>
    </div>
</div>

<div id="gameRoom" class="container hidden">
    <div class="box">
        <div class="box-header">
            <span id="roomTitle">게임 방</span>
            <span id="timerDisplay" style="color:#cf222e; font-weight:bold; font-family: monospace;">[대기 중]</span>
        </div>
        <div id="errorOutput" style="padding: 10px; color:#cf222e; font-size:13px; font-weight:bold; display:none;"></div>
        <div id="chatOutput"></div>
        <div style="padding: 16px; border-top: 1px solid var(--border-color);">
            <div style="display: flex; gap: 10px;">
                <input type="text" id="wordInput" placeholder="단어를 입력하세요..." disabled style="flex: 1;" onkeypress="if(event.key==='Enter') sendWord()">
                <button id="sendWordBtn" class="btn-primary" style="width: 80px;" onclick="sendWord()">입력</button>
            </div>
            <div style="margin-top: 10px; display: flex; justify-content: space-between;">
                <button id="forfeitBtn" class="btn-danger" onclick="forfeitTurn()" disabled>기권</button>
                <button id="leaveRoomBtn" class="btn-default" onclick="exitRoom()">나가기</button>
            </div>
        </div>
    </div>
</div>

<script src="/KKUTU/game.js"></script>
</body>
</html>